extends _layout

block menu
  .pure-menu.pure-menu-horizontal
    ul.pure-menu-list
      li.pure-menu-item
        a.pure-menu-link(href='/') Servers
      li.pure-menu-item
        span= server.name


block content
 
    span#success.alert.alert-success(role="alert" style="display:none;widht:100%;") 
        span Success 
        span Команда выполнена
 
    span#error.alert.alert-success(role="alert" style="display:none;widht:100%;") 
        span Error 
        span Команда не выполнена


    form.pure-form.pure-form-aligned
      fieldset
        each command in server.commands
          .pure-control-group
          
            label= command.name

            a.commandButton2.pure-button.pure-button-primary(
              data-url="/server/" + server.name + "/run/" + command.name
              data-name=command.name
            ) run

    script.
        $('.commandButton2').on('click', function () {
            $this = $(this);
            $success = $('#success');
            $error = $('#error');

            var result = confirm('Хотите выполнить ' + $this.data('name') + '?');

            if (result) {
                $.ajax($this.data('url'), {
                    success: function () {
                        console.log('success');
                        $success.show();
                        setTimeout(function () {
                            $success.hide();
                        }, 5000);
                    },
                    error: function () {
                        console.log('error');
                        $error.show();
                        setTimeout(function () {
                            $error.hide();
                        }, 5000);
                    }
                })
            
            } else {
                return false;
            }
          }
        );